{
  "ok": false,
  "vulnerabilities": [
    {
      "id": "SNYK-JS-JSONWEBTOKEN-3180022",
      "title": "Improper Authentication",
      "CVSSv3": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:L",
      "credit": [
        "Unknown"
      ],
      "semver": {
        "vulnerable": [
          "<9.0.0"
        ]
      },
      "exploit": "Not Defined",
      "fixedIn": [
        "9.0.0"
      ],
      "patches": [],
      "insights": {
        "triageAdvice": null
      },
      "language": "js",
      "severity": "medium",
      "cvssScore": 6.4,
      "functions": [],
      "malicious": false,
      "isDisputed": false,
      "moduleName": "jsonwebtoken",
      "references": [
        {
          "url": "https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3",
          "title": "GitHub Commit"
        },
        {
          "url": "https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0",
          "title": "GitHub Release"
        }
      ],
      "cvssDetails": [
        {
          "assigner": "NVD",
          "severity": "high",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L",
          "cvssV3BaseScore": 7.6,
          "modificationTime": "2023-02-28T01:10:17.504751Z"
        }
      ],
      "description": "## Overview\n[jsonwebtoken](https://github.com/auth0/node-jsonwebtoken) is a JSON Web Token implementation (symmetric and asymmetric)\n\nAffected versions of this package are vulnerable to Improper Authentication such that the lack of algorithm definition in the `jwt.verify()` function can lead to signature validation bypass due to defaulting to the `none` algorithm for signature verification. \r\n\r\n## Exploitability\r\nUsers are affected only if all of the following conditions are true for the `jwt.verify()` function:\r\n\r\n1) A token with no signature is received.\r\n\r\n2) No algorithms are specified.\r\n\r\n3) A falsy (e.g., `null`, `false`, `undefined`) secret or key is passed.\n## Remediation\nUpgrade `jsonwebtoken` to version 9.0.0 or higher.\n## References\n- [GitHub Commit](https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3)\n- [GitHub Release](https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0)\n",
      "epssDetails": {
        "percentile": "0.12836",
        "probability": "0.00046",
        "modelVersion": "v2023.03.01"
      },
      "identifiers": {
        "CVE": [
          "CVE-2022-23540"
        ],
        "CWE": [
          "CWE-287"
        ],
        "GHSA": [
          "GHSA-qwph-4952-7xr6"
        ]
      },
      "packageName": "jsonwebtoken",
      "proprietary": false,
      "creationTime": "2022-12-22T09:09:36.072853Z",
      "functions_new": [],
      "alternativeIds": [],
      "disclosureTime": "2022-12-22T03:32:59Z",
      "packageManager": "npm",
      "publicationTime": "2022-12-22T09:13:25.290846Z",
      "modificationTime": "2023-02-28T01:10:17.504751Z",
      "socialTrendAlert": false,
      "severityWithCritical": "medium",
      "packagePopularityRank": 99,
      "from": [
        "kusto@DonJayamanne/vscode-kusto#0a4f8081bc94052eddfc8f11b53527c34c12e7a0",
        "azure-kusto-data@2.2.3",
        "@azure/identity@1.5.2",
        "@azure/msal-node@1.0.0-beta.6",
        "jsonwebtoken@8.5.1"
      ],
      "upgradePath": [
        false,
        "azure-kusto-data@3.0.0",
        "@azure/identity@2.0.1",
        "@azure/msal-node@1.14.6",
        "jsonwebtoken@9.0.0"
      ],
      "version": "8.5.1",
      "name": "jsonwebtoken",
      "isUpgradable": true,
      "isPatchable": false,
      "isPinnable": false
    },
    {
      "id": "SNYK-JS-JSONWEBTOKEN-3180024",
      "title": "Improper Restriction of Security Token Assignment",
      "CVSSv3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
      "credit": [
        "Unknown"
      ],
      "semver": {
        "vulnerable": [
          "<9.0.0"
        ]
      },
      "exploit": "Not Defined",
      "fixedIn": [
        "9.0.0"
      ],
      "patches": [],
      "insights": {
        "triageAdvice": null
      },
      "language": "js",
      "severity": "medium",
      "cvssScore": 6.5,
      "functions": [],
      "malicious": false,
      "isDisputed": false,
      "moduleName": "jsonwebtoken",
      "references": [
        {
          "url": "https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3",
          "title": "GitHub Commit"
        },
        {
          "url": "https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0",
          "title": "GitHub Release"
        }
      ],
      "cvssDetails": [
        {
          "assigner": "NVD",
          "severity": "medium",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
          "cvssV3BaseScore": 6.3,
          "modificationTime": "2023-02-28T01:10:17.572355Z"
        }
      ],
      "description": "## Overview\n[jsonwebtoken](https://github.com/auth0/node-jsonwebtoken) is a JSON Web Token implementation (symmetric and asymmetric)\n\nAffected versions of this package are vulnerable to Improper Restriction of Security Token Assignment via the `secretOrPublicKey ` argument due to misconfigurations of the key retrieval function `jwt.verify()`. Exploiting this vulnerability might result in incorrect verification of forged tokens when tokens signed with an asymmetric public key could be verified with a symmetric HS256 algorithm.\r\n\r\n**Note:**\r\nThis vulnerability affects your application if it supports the usage of both symmetric and asymmetric keys in `jwt.verify()` implementation with the same key retrieval function.\n## Remediation\nUpgrade `jsonwebtoken` to version 9.0.0 or higher.\n## References\n- [GitHub Commit](https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3)\n- [GitHub Release](https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0)\n",
      "epssDetails": {
        "percentile": "0.18857",
        "probability": "0.00053",
        "modelVersion": "v2023.03.01"
      },
      "identifiers": {
        "CVE": [
          "CVE-2022-23541"
        ],
        "CWE": [
          "CWE-1259"
        ],
        "GHSA": [
          "GHSA-hjrf-2m68-5959"
        ]
      },
      "packageName": "jsonwebtoken",
      "proprietary": false,
      "creationTime": "2022-12-22T09:14:27.155728Z",
      "functions_new": [],
      "alternativeIds": [],
      "disclosureTime": "2022-12-22T03:33:19Z",
      "packageManager": "npm",
      "publicationTime": "2022-12-22T09:16:03.621406Z",
      "modificationTime": "2023-02-28T01:10:17.572355Z",
      "socialTrendAlert": false,
      "severityWithCritical": "medium",
      "packagePopularityRank": 99,
      "from": [
        "kusto@DonJayamanne/vscode-kusto#0a4f8081bc94052eddfc8f11b53527c34c12e7a0",
        "azure-kusto-data@2.2.3",
        "@azure/identity@1.5.2",
        "@azure/msal-node@1.0.0-beta.6",
        "jsonwebtoken@8.5.1"
      ],
      "upgradePath": [
        false,
        "azure-kusto-data@3.0.0",
        "@azure/identity@2.0.1",
        "@azure/msal-node@1.14.6",
        "jsonwebtoken@9.0.0"
      ],
      "version": "8.5.1",
      "name": "jsonwebtoken",
      "isUpgradable": true,
      "isPatchable": false,
      "isPinnable": false
    },
    {
      "id": "SNYK-JS-JSONWEBTOKEN-3180026",
      "title": "Use of a Broken or Risky Cryptographic Algorithm",
      "CVSSv3": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
      "credit": [
        "Unknown"
      ],
      "semver": {
        "vulnerable": [
          "<9.0.0"
        ]
      },
      "exploit": "Not Defined",
      "fixedIn": [
        "9.0.0"
      ],
      "patches": [],
      "insights": {
        "triageAdvice": null
      },
      "language": "js",
      "severity": "medium",
      "cvssScore": 6.8,
      "functions": [],
      "malicious": false,
      "isDisputed": false,
      "moduleName": "jsonwebtoken",
      "references": [
        {
          "url": "https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3",
          "title": "GitHub Commit"
        },
        {
          "url": "https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0",
          "title": "GitHub Release"
        }
      ],
      "cvssDetails": [
        {
          "assigner": "NVD",
          "severity": "high",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
          "cvssV3BaseScore": 8.1,
          "modificationTime": "2022-12-31T01:11:45.823807Z"
        }
      ],
      "description": "## Overview\n[jsonwebtoken](https://github.com/auth0/node-jsonwebtoken) is a JSON Web Token implementation (symmetric and asymmetric)\n\nAffected versions of this package are vulnerable to Use of a Broken or Risky Cryptographic Algorithm such that the library can be misconfigured to use legacy, insecure key types for signature verification. For example, DSA keys could be used with the RS256 algorithm. \r\n\r\n## Exploitability\r\n\r\nUsers are affected when using an algorithm and a key type _other_ than the combinations mentioned below:\r\n\r\nEC: ES256, ES384, ES512\r\n                  \r\nRSA: RS256, RS384, RS512, PS256, PS384, PS512 \r\n\r\nRSA-PSS: PS256, PS384, PS512                      \r\n\r\nAnd for Elliptic Curve algorithms:\r\n\r\nES256: prime256v1\r\n\r\nES384: secp384r1\r\n\r\nES512:  secp521r1 \r\n\r\n## Workaround \r\n\r\nUsers who are unable to upgrade to the fixed version can use the  `allowInvalidAsymmetricKeyTypes` option  to `true` in the `sign()` and `verify()` functions to continue usage of invalid key type/algorithm combination in 9.0.0 for legacy compatibility.\n## Remediation\nUpgrade `jsonwebtoken` to version 9.0.0 or higher.\n## References\n- [GitHub Commit](https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3)\n- [GitHub Release](https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0)\n",
      "epssDetails": {
        "percentile": "0.16925",
        "probability": "0.00050",
        "modelVersion": "v2023.03.01"
      },
      "identifiers": {
        "CVE": [
          "CVE-2022-23539"
        ],
        "CWE": [
          "CWE-327"
        ],
        "GHSA": [
          "GHSA-8cf7-32gw-wr33"
        ]
      },
      "packageName": "jsonwebtoken",
      "proprietary": false,
      "creationTime": "2022-12-22T09:19:03.430735Z",
      "functions_new": [],
      "alternativeIds": [],
      "disclosureTime": "2022-12-22T03:32:22Z",
      "packageManager": "npm",
      "publicationTime": "2022-12-22T10:32:50.173080Z",
      "modificationTime": "2023-01-01T13:30:43.098324Z",
      "socialTrendAlert": false,
      "severityWithCritical": "medium",
      "packagePopularityRank": 99,
      "from": [
        "kusto@DonJayamanne/vscode-kusto#0a4f8081bc94052eddfc8f11b53527c34c12e7a0",
        "azure-kusto-data@2.2.3",
        "@azure/identity@1.5.2",
        "@azure/msal-node@1.0.0-beta.6",
        "jsonwebtoken@8.5.1"
      ],
      "upgradePath": [
        false,
        "azure-kusto-data@3.0.0",
        "@azure/identity@2.0.1",
        "@azure/msal-node@1.14.6",
        "jsonwebtoken@9.0.0"
      ],
      "version": "8.5.1",
      "name": "jsonwebtoken",
      "isUpgradable": true,
      "isPatchable": false,
      "isPinnable": false
    }
  ],
  "numDependencies": 489,
  "severityMap": {
    "critical": 0,
    "high": 0,
    "medium": 3,
    "low": 0
  },
  "org": "bruswei",
  "packageManager": "npm",
  "summary": "3 vulnerable dependency paths",
  "filesystemPolicy": false,
  "filtered": {
    "ignore": [],
    "patch": []
  },
  "uniqueCount": 3,
  "hasUnknownVersions": false,
  "path": "https://github.com/DonJayamanne/vscode-kusto.git"
}
